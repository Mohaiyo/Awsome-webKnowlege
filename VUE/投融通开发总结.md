# 投融通开发总结

> 乱七八糟的，想到什么写什么

## 入口文件

> 首先入口文件route.js使用 vue异步组件的思想

- 使用 resolve => require([./path/asyncComp.vue], resolve)  这个在webpack版本是1.x的时候适用
- 当你使用webpack 2 + ES2015的时候，可以使用 () => import('./my-async-component') 来进行代码分割以及异步加载 也就是动态import 需要添加 syntax-dynamic-import 插件（使用babel时）

## 首页

> 分为两个组件开发
- 投融资管理组件
  > 处理登录逻辑 cbsLogin()
  ***
  > 第一次登录的时候需要在url中加入参数，然后存入sessionStorage() 在跳转回首页的时候就不用再去加参数 然后在使用this.$emit('hasLogin') 触发实例上的hasLogin自定义事件 查询产品列表
  ***
  > 已经登录成功才可以去查询产品列表，查询投资概况以及融资笔数  否则无权限  登录成功之后如果antflg == 'N' 代表没有权限
  ***
  > 如果没有权限了还可以继续查询数据？  应该代码不可以继续执行了  return false
  ***
  > 组件之间使用props属性通讯
  - 投资管理组件
    > 投资管理使用echarts展示产品账号以及持有份额
  - 融资管理组件
    > 轮播使用element-ui 的carousel组件
- 产品滚动轮播组件
  >  自己开发一个产品轮播组件  使用dom操作 style.left向左移动  offsetWidth  scrollWidth clientWidth等的使用

## 账户详情

> 主要是页面布局，然后获取数据
> 持仓列表直接用el-table组件

## 投资产品

> 使用 el-table
***
> 分页使用 el-pagenation
***
> 样式 布局  数据
***
> 全局的格式化的plugins的方法的使用

## 投资产品详情

> el-dialog的使用
***
> table的使用  th td tr tbody thead
***
> 输入框的控制  不能输入英文汉字等
***
> 返回的 数据格式控制
***
> 什么情况下会用到 this.$nextTick(function(){})  在修改数据之后，直接用此方法，获取更新之后的dom

```js
new Vue({
  // ...
  methods: {
    // ...
    example: function () {
      // 修改数据
      this.message = 'changed'
      // DOM 还没有更新
      this.$nextTick(function () {
        // DOM 现在更新了
        // `this` 绑定到当前实例
        this.doSomethingElse()
      })
    }
  }
})
```

> 投资金额  输入框kepup时 使用正则方法过滤掉以下规则的输入：

- 禁止输入以小数点开头的
- 禁止录入任何非数字和点
- 禁止录入两个以上的点

***
> 投资金额  输入框focus时转换成正常的金额  blur时，转换成带逗号分隔的格式  都需要用到正则表达式
***
> 投资金额大写的转换
***
> 点击立即申购的时候
- 判断申购按钮是否可以点击 如果不可以点击  return false 否则让其先变成不可以点击
- 判断输入金额是否为空或者为0或者申购金额小于起购金额
- 然后去查询基金交易总额接口，查询当天的交易额，判断是否超过当日限额，如果超过，提示超额
- 如果金额已经满足，则判断风险测评，如果没有做过风险测评弹框提示做风险测评，如果已经做过风险测评，则判断基金风险等级与账户的风险等级是否匹配，不匹配就提示
- 如果条件都符合和就跳转到购买页面

> 点击立即开户
- 判断是否做过风险测评，如果没有则跳转到风险测评，如果已经做过风险测评则跳转到开户页面

> 页面进来之后先去查询基金产品详情
- 根据开户状态来判断是显示立即开户还是立即申购

> echarts展示7日化年收益以及万份收益